# 小程序和公众号

## 1.定位不同

### 1.1公众号

公众号借助`H5`实现简单交互，主要用于信息的传递，一些简单的服务为辅助，体验类似于浏览网页，复杂应用会有多层页面跳转，没有缓存，打开会有延时。

### 1.2小程序

小程序主要是面向应用，功能上和公众号有区分(不支持关注，消息推送，朋友圈)，体验类似原生App,无需安装，用完可走。有本地缓存，加载比较流畅。

## 2.公众号关联小程序

- 公众号关联小程序后，将可在图文消息、自定义菜单、模板消息等功能中使用小程序。
- 关联规则
  - 所有公众号都可以关联小程序。
  - 一个公众号可关联10个同主体的小程序，3个不同主体的小程序。
  - 一个小程序可关联500个公众号。
  - 公众号一个月可新增关联小程序13次，小程序一个月可新增关联500次。

## 3.对比

|        | 实现技术                   | 运行环境   | 便捷性   | 账户体系               | 推广           |
| ------ | -------------------------- | ---------- | -------- | ---------------------- | -------------- |
| 公众号 | H5                         | 浏览器     | 先关注   | 独立公众号用户         | 微信群，朋友圈 |
| 小程序 | 微信自身开发环境与开发语言 | 微信移动端 | 无需关注 | 独立小程序用户(可打通) | 微信群         |

### 3.1小程序

- 可以分享小程序页面
- 模板消息(发生支付行为可以给用户发消息，微信订票，发车前的通知消息等)
- 客服消息(相当于淘宝客服)
- 小程序每个页面都可以使用二维码扫一扫打开
- 可以直接调用系统蓝牙
- 可以后台存活
- 无刷新及时通信，可本地缓存
- 微信官方封装了很多接口，开发成本相对较低
- 类似于vue的开发体验，开发比较快捷
- 可以查看附近5公里小程序

### 3.2公众号

- 可分享，推荐
- 消息通知无限制使用
- 需要接入微信硬件平台
- 不可后台存活
- 每次打开要请求服务器，延时大
- 接口相对于小程序封装程度不高，成本相对高一点

## 4.小程序接口

- 获取手机网络状态(wifi 4g..)
- 监听手机网络变化
- 获取手机系统信息
  - 品牌，手机信号，微信语言，微信版本，屏幕宽度高度，DPI
- 获取重力感应数据
- 打电话
- 扫一扫
- 上传下载文件
- 背景音乐(小程序离开也可以播放音乐)
- 微信支付
- 实时音视频
- 蓝牙适配器
- 屏幕截屏事件
- NFC(安卓手机模拟成实体智能卡。适用机型：支持 NFC 功能，且系统版本为Android5.0及以上的手机)
- `微信运动`获取用户过去三十天微信运动步数，需要先调用登录接口，获得授权
- `打开另一个小程序`:打开同一公众号下关联的另一个小程序。
- `打开app`:因为需要用户主动触发才能打开 APP，所以该功能不由 API 来调用，需要用 `open-type` 的值设置为 `launchApp` 的 `<button>` 组件的点击来触发。
- `生物认证`：获取本机支持的 SOTER 生物认证方式：目前支持指纹识别，facial(人脸识别)，speech(声纹识别)暂未支持

## 5.公众号设备功能接口

**介绍**：设备功能允许硬件设备厂商通过服务号，将用户与其拥有的智能设备相连。通过微信硬件平台规定的连接协议，各种智能 设备如蓝牙设备、WIFI设备和其他移动网络设备都能方便的接入微信，完成设备、人、服务三者 的连接。微信硬件平台同时还提供了AirSync, AirKiss等用于蓝牙和WIFI技术的基础支持框架，以及硬件JSAPI等， 以方便硬件开发人员快速地将微信与智能设备进行互联。

**接入后可以做什么**

- 接入微信运动，设备可以向微信上报步数，厂商公众号可以拉入步数排行榜
- 通过公众号常规接口向设备发送微信消息，语音，文字，图片等
- 用户可以转发微信朋友圈，聊天界面的图片，文档，地图位置给设备
- 通过公众号下发消息通知，提醒，告警等。
- 使用微信快速为Wi-Fi设备配置家庭网络。
- 在用户首次使用设备时提供引导说明。

**设备如何与微信连接**

- 蓝牙设备连接到微信客户端，通过微信客户端与生产商业务服务器通讯。
- 设备通过内嵌微信SDK，与微信服务器通讯。
- 设备连接生产商业务服务器，业务服务器再与微信服务器通讯。


